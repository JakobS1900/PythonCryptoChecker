{% extends "base.html" %}

{% block title %}Social - CryptoChecker{% endblock %}

{% block extra_css %}
<style>
    .social-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 2rem;
    }

    .social-header {
        text-align: center;
        margin-bottom: 2rem;
    }

    .social-header h1 {
        font-size: 2.5rem;
        font-weight: 700;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    /* Tabs */
    .social-tabs {
        display: flex;
        gap: 1rem;
        margin-bottom: 2rem;
        border-bottom: 2px solid var(--card-border);
    }

    .tab-btn {
        padding: 1rem 2rem;
        background: none;
        border: none;
        color: var(--text-secondary);
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        border-bottom: 3px solid transparent;
        transition: all 0.3s;
    }

    .tab-btn:hover {
        color: var(--primary);
    }

    .tab-btn.active {
        color: var(--primary);
        border-bottom-color: var(--primary);
    }

    .tab-content {
        display: none;
    }

    .tab-content.active {
        display: block;
    }

    /* Friends Tab */
    .friends-grid {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 2rem;
    }

    .friends-list, .requests-panel {
        background: var(--card-bg);
        border: 1px solid var(--card-border);
        border-radius: 12px;
        padding: 1.5rem;
    }

    .section-title {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 1rem;
    }

    .friend-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1rem;
        background: var(--surface);
        border: 1px solid var(--card-border);
        border-radius: 8px;
        margin-bottom: 0.75rem;
    }

    .friend-info {
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .online-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: var(--error);
    }

    .online-indicator.online {
        background: var(--success);
    }

    .friend-name {
        font-weight: 600;
        font-size: 1.1rem;
    }

    .friend-balance {
        color: var(--gem);
        font-size: 0.9rem;
    }

    .friend-actions {
        display: flex;
        gap: 0.5rem;
    }

    .btn-sm {
        padding: 0.5rem 1rem;
        border: none;
        border-radius: 6px;
        font-size: 0.9rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
    }

    .btn-primary {
        background: var(--primary);
        color: white;
    }

    .btn-success {
        background: var(--success);
        color: white;
    }

    .btn-danger {
        background: var(--error);
        color: white;
    }

    .btn-sm:hover {
        transform: translateY(-1px);
        opacity: 0.9;
    }

    .search-box {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1.5rem;
    }

    .search-input {
        flex: 1;
        padding: 0.75rem;
        border: 1px solid var(--card-border);
        border-radius: 8px;
        background: var(--surface);
        color: var(--text-primary);
    }

    /* Messages Tab */
    .messages-grid {
        display: grid;
        grid-template-columns: 1fr 2fr;
        gap: 2rem;
        height: 600px;
    }

    .conversations-list {
        background: var(--card-bg);
        border: 1px solid var(--card-border);
        border-radius: 12px;
        padding: 1rem;
        overflow-y: auto;
    }

    .conversation-item {
        padding: 1rem;
        background: var(--surface);
        border: 1px solid var(--card-border);
        border-radius: 8px;
        margin-bottom: 0.75rem;
        cursor: pointer;
        transition: all 0.2s;
    }

    .conversation-item:hover {
        border-color: var(--primary);
        background: var(--card-bg);
    }

    .conversation-item.active {
        border-color: var(--primary);
        background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, transparent 100%);
    }

    .unread-badge {
        background: var(--error);
        color: white;
        padding: 0.25rem 0.5rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 700;
    }

    .chat-container {
        background: var(--card-bg);
        border: 1px solid var(--card-border);
        border-radius: 12px;
        display: flex;
        flex-direction: column;
    }

    .chat-header {
        padding: 1rem;
        border-bottom: 1px solid var(--card-border);
        font-weight: 600;
        font-size: 1.1rem;
    }

    .chat-messages {
        flex: 1;
        padding: 1rem;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
    }

    .message {
        max-width: 70%;
        padding: 0.75rem 1rem;
        border-radius: 12px;
        word-wrap: break-word;
    }

    .message.mine {
        align-self: flex-end;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
    }

    .message.theirs {
        align-self: flex-start;
        background: var(--surface);
        border: 1px solid var(--card-border);
    }

    .chat-input {
        padding: 1rem;
        border-top: 1px solid var(--card-border);
        display: flex;
        gap: 0.5rem;
    }

    .chat-input input {
        flex: 1;
        padding: 0.75rem;
        border: 1px solid var(--card-border);
        border-radius: 8px;
        background: var(--surface);
        color: var(--text-primary);
    }

    /* Activity Tab */
    .activity-container {
        max-width: 800px;
        margin: 0 auto;
    }

    .activity-filters {
        display: flex;
        gap: 1rem;
        margin-bottom: 2rem;
    }

    .filter-btn {
        padding: 0.75rem 1.5rem;
        border: 1px solid var(--card-border);
        border-radius: 8px;
        background: var(--surface);
        color: var(--text-primary);
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
    }

    .filter-btn.active {
        background: var(--primary);
        color: white;
        border-color: var(--primary);
    }

    .activity-item {
        background: var(--card-bg);
        border: 1px solid var(--card-border);
        border-radius: 12px;
        padding: 1.5rem;
        margin-bottom: 1rem;
    }

    .activity-header {
        display: flex;
        justify-content: space-between;
        align-items: start;
        margin-bottom: 0.75rem;
    }

    .activity-user {
        font-weight: 600;
        color: var(--primary);
    }

    .activity-time {
        color: var(--text-secondary);
        font-size: 0.85rem;
    }

    .activity-title {
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
    }

    .activity-description {
        color: var(--text-secondary);
    }

    .activity-badge {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 700;
        text-transform: uppercase;
    }

    .badge-win { background: rgba(16, 185, 129, 0.2); color: var(--success); }
    .badge-achievement { background: rgba(245, 158, 11, 0.2); color: #f59e0b; }
    .badge-level { background: rgba(59, 130, 246, 0.2); color: var(--primary); }

    @media (max-width: 1024px) {
        .friends-grid, .messages-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="social-container">
    <!-- Header -->
    <div class="social-header">
        <h1>ðŸ‘¥ Social</h1>
        <p>Connect with friends, send messages, and share your wins!</p>
    </div>

    <!-- Tabs -->
    <div class="social-tabs">
        <button class="tab-btn active" onclick="Social.switchTab('friends')">
            <i class="bi bi-people"></i> Friends
        </button>
        <button class="tab-btn" onclick="Social.switchTab('messages')">
            <i class="bi bi-chat-dots"></i> Messages
            <span class="unread-badge" id="messages-badge" style="display: none;">0</span>
        </button>
        <button class="tab-btn" onclick="Social.switchTab('activity')">
            <i class="bi bi-activity"></i> Activity
        </button>
    </div>

    <!-- Friends Tab -->
    <div id="friends-tab" class="tab-content active">
        <div class="friends-grid">
            <!-- Friends List -->
            <div class="friends-list">
                <h3 class="section-title">My Friends (<span id="friends-count">0</span>)</h3>

                <div class="search-box">
                    <input type="text" class="search-input" id="user-search" placeholder="Search users...">
                    <button class="btn-sm btn-primary" onclick="Social.searchUsers()">
                        <i class="bi bi-search"></i> Search
                    </button>
                </div>

                <div id="friends-container">
                    <p class="text-secondary">No friends yet. Search for users to add!</p>
                </div>
            </div>

            <!-- Friend Requests -->
            <div class="requests-panel">
                <h3 class="section-title">Friend Requests</h3>

                <h4 style="font-size: 1rem; margin-top: 1.5rem; margin-bottom: 0.75rem;">Received</h4>
                <div id="requests-received">
                    <p class="text-secondary">No pending requests</p>
                </div>

                <h4 style="font-size: 1rem; margin-top: 1.5rem; margin-bottom: 0.75rem;">Sent</h4>
                <div id="requests-sent">
                    <p class="text-secondary">No pending requests</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Messages Tab -->
    <div id="messages-tab" class="tab-content">
        <div class="messages-grid">
            <!-- Conversations List -->
            <div class="conversations-list">
                <h3 class="section-title">Conversations</h3>
                <div id="conversations-container">
                    <p class="text-secondary">No conversations yet</p>
                </div>
            </div>

            <!-- Chat -->
            <div class="chat-container">
                <div class="chat-header" id="chat-header">
                    Select a conversation
                </div>
                <div class="chat-messages" id="chat-messages">
                    <p class="text-secondary text-center">Select a friend to start chatting</p>
                </div>
                <div class="chat-input">
                    <input type="text" id="message-input" placeholder="Type a message..." disabled>
                    <button class="btn-sm btn-primary" onclick="Social.sendMessage()" disabled id="send-btn">
                        <i class="bi bi-send"></i> Send
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Activity Tab -->
    <div id="activity-tab" class="tab-content">
        <div class="activity-container">
            <div class="activity-filters">
                <button class="filter-btn active" onclick="Social.switchActivityFeed('me')">
                    My Activity
                </button>
                <button class="filter-btn" onclick="Social.switchActivityFeed('friends')">
                    Friends' Activity
                </button>
            </div>

            <div id="activity-container">
                <p class="text-secondary">No activity yet</p>
            </div>
        </div>
    </div>
</div>

<script src="/static/js/social.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        Social.init();
    });
</script>
{% endblock %}
